<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <label for="total_marks">Total Marks</label>
    <input type="number" id="total_marks" min="20" max="500" step="10">
    <br>
    <br>
    <h4>Distribution of difficulty</h4>
    <label for=" easyPercent">Percentage of Easy questions</label>
    <input type="number" id="easyPercent" name="incrementByTen" step="5" min="0" max="100">
    <br>
    <br>
    <label for="mediumPercent">Percentage of Medium questions</label>
    <input type="number" id="mediumPercent" name="incrementByTen" step="10" min="0" max="100">
    <br>
    <br>
    <label for="hardPercent">Percentage of Hard questions</label>
    <input type="number" id="hardPercent" name="incrementByTen" step="15" min="0" max="100">
    <br>
    <br>
    <input type="checkbox" id="subjectBoolean" onclick="checkBoxClick(this)"> <label for="subjectBoolean">Based on
        subject</label>
    <br>
    <div id="subjectDiv" style="display: none">

        <h4>Distribution of Subject</h4>
        <label for="physicsPercent">Percentage of Physics questions</label>
        <input type="number" id="physicsPercent" name="incrementByTen" min="0" max="100">
        <br>
        <br>
        <label for="chemistryPercent">Percentage of Chemistry questions</label>
        <input type="number" id="chemistryPercent" name="incrementByTen" min="0" max="100">
        <br>
    </div>
    <button id="" style="margin-top: 20px; padding:5px; cursor: pointer;" onclick="formHandler()">Generate
        Paper</button>

    <div id="generated_paper">

    </div>
</body>

<script>
    const checkBoxClick = (checkbox) => {
        if (checkbox.checked) {
            document.getElementById("subjectDiv").style.display = "block";
        }
        else {
            document.getElementById("subjectDiv").style.display = "none"
        }
    }
    // const formHandler = (e) => {
    //     const totalMarks = document.getElementById("total_marks").value;
    //     let difficultyDistribution = {
    //         Easy: document.getElementById("easyPercent").value,
    //         Medium: document.getElementById("mediumPercent").value,
    //         Hard: document.getElementById("hardPercent").value,
    //     }
    //     let subjectDistribution = {};
    //     if (document.getElementById("subjectBoolean").checked) {
    //         subjectDistribution["Physics"] = document.getElementById("physicsPercent").value
    //         subjectDistribution["Chemistry"] = document.getElementById("chemistryPercent").value
    //     }
    //     var apiUrl = 'http://localhost:3000/generate-question-paper';
    //     const postData = {
    //         totalMarks,
    //         difficultyDistribution,
    //         subjectDistribution
    //     }
    //     const paper = fetch(apiUrl, {
    //         method: 'POST',
    //         headers: {
    //             'Content-Type': 'application/json',
    //         },
    //         body: JSON.stringify(postData),
    //     })

    //     console.log(paper)
    // }
    let diviser;
    const input = document.getElementById("total_marks")
    input.addEventListener("input", (e) => {
        diviser = e.target.value / 100;
        console.log(diviser)
        document.getElementById("easyPercent").step = 5 / diviser;
        document.getElementById("mediumPercent").step = 10 / diviser;
        document.getElementById("hardPercent").step = 15 / diviser;
    })
    const formHandler = () => {
        // Prevent the default form submission behavior

        const totalMarks = document.getElementById("total_marks").value;

        let difficultyDistribution = {
            Easy: document.getElementById("easyPercent").value,
            Medium: document.getElementById("mediumPercent").value,
            Hard: document.getElementById("hardPercent").value,
        }
        let subjectDistribution = {};
        if (document.getElementById("subjectBoolean").checked) {
            subjectDistribution["Physics"] = document.getElementById("physicsPercent").value
            subjectDistribution["Chemistry"] = document.getElementById("chemistryPercent").value
        }

        var apiUrl = 'http://localhost:3000/generate-question-paper';
        const postData = {
            totalMarks,
            difficultyDistribution,
            subjectDistribution
        }
        console.log("hi")
        let paper = [];
        fetch(apiUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(postData),
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json(); // Assuming the response is in JSON format
            })
            .then(data => {
                console.log('Data received:', data.questionPaper);
                paper = data.questionPaper;
                document.getElementById("generated_paper").innerHTML = ""
                for (const [index, question] of paper.entries()) {
                    const div = document.createElement('div');
                    div.innerHTML = `
                     <h4>Question${index + 1} = ${question.question}</h4>
                     <p>Difficulty = ${question.difficulty}</p> 
                     <p>Subject = ${question.subject}</p> 
                     <p>Marks = ${question.marks}</p> 
                     <p>Topic = ${question.topic}</p> 
                    `;
                    document.getElementById("generated_paper").appendChild(div);
                }
            })
            .catch(error => {
                console.error('Fetch error:', error);
            });
    }

</script>

</html>